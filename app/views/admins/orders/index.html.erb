<%= render 'admins/users/header' %>
<div class="main-box">
  <h4>注文一覧</h4>

<%= search_form_for @q, url:admins_orders_index_path, method: :get do |f| %>
  <%= f.search_field :id_eq %>
  <%= f.submit "ID検索"%>
<% end %>

<div class="container">
  <div class="ad-pro-index-box">
    <table class="table table-hover">
      <thead>
        <tr>
          <th></th>
          <th><%= sort_link(@q, :id, "オーダーNo.") %></th>
          <th><%= sort_link(@q, :status, "ステータス") %></th>
          <th><%= @msg %><%= @msg2 %></th>
          <th><%= sort_link(@q, :created_at, "購入日") %></th>
          <th><%= sort_link(@q, :user_id, "ユーザー名") %></th>
          <th><%= sort_link(@q, :total, "合計") %></th>
        </tr>
      </thead>
      <tbody>
        <% @orders.each do |order| %>
          <%#= form_for order, url: admins_order_update_path(order), method: :patch do |f| %>
            <tr>
              <th><input type="checkbox"></th>
              <td><%= link_to admins_order_show_path(order.id) do %>
                    #<%= order.id %>-<%= order.created_at.strftime('%Y%m%d') %>
                  <% end %>
              </td>
              <td>
                <%= order.status %>
              </td>
              <td>
                <%= form_for order, url: admins_order_update_path(order), method: :patch do |f| %>
                  <%= f.select :status, Order.statuses.keys.to_a %>
                  <button type="submit" class="update-button">ステータス更新</button>
                <% end %>
              </td>
              <td><%= order.created_at.strftime('%Y/%m/%d %H:%M') %></td>
              <td><%= link_to admins_user_path(order.user), method: :get do %>
                <%=order.user.first_name %><%= order.user.last_name %>
                  <% end %>
                </td>
              <td>¥ <%= order.total %></td>
            </tr>
          <%# end %>
        <% end %>
      </tbody>
    </table>
  <%= paginate @orders %>
  </div>
</div>

